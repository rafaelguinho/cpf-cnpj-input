{"version":3,"file":"index.js","sources":["../src/components/CpfCnpjInput/index.tsx"],"sourcesContent":["import React from 'react'\r\n\r\ntype CpfCnpjInputProps = {\r\n  as?: React.FC<any & InputProps>\r\n  style?: React.CSSProperties\r\n}\r\n\r\ntype InputProps = JSX.IntrinsicElements['input']\r\n\r\nexport function clearCpfCnpj(value: string) {\r\n  return value && value.replace(/[^0-9]/g, '')\r\n}\r\n\r\nexport function isCpf(value: string) {\r\n  return value.length === 11\r\n}\r\n\r\nexport function isCnpj(value: string) {\r\n  return value.length === 14\r\n}\r\n\r\nconst CpfCnpjInput: React.FC<CpfCnpjInputProps & InputProps> = ({\r\n  as,\r\n  style,\r\n  name = 'cpf_cnpj',\r\n  value = '',\r\n  onChange,\r\n  type,\r\n  ...rest\r\n}: CpfCnpjInputProps & InputProps) => {\r\n  const TYPES = {\r\n    CPF: '999.999.999-999',\r\n    CNPJ: '99.999.999/9999-99'\r\n  }\r\n  const MAX_LENGTH = clearCpfCnpj(TYPES.CNPJ).length\r\n\r\n  const stringValue = String(value)\r\n\r\n  const clearedValue = clearCpfCnpj(stringValue)\r\n  const maskedValue = clearedValue\r\n    ? applyMask(clearedValue, TYPES[getMask(clearedValue)])\r\n    : clearedValue\r\n\r\n  function onLocalChange(ev: React.ChangeEvent<HTMLInputElement>) {\r\n    const value = clearCpfCnpj(ev.target.value)\r\n    const mask = getMask(value)\r\n\r\n    let nextLength = value.length\r\n\r\n    const maskedValue =\r\n      nextLength > MAX_LENGTH\r\n        ? applyMask(value.substring(0, MAX_LENGTH), TYPES[mask])\r\n        : applyMask(value, TYPES[mask])\r\n\r\n    ev.target.value = maskedValue\r\n\r\n    onChange && onChange(ev)\r\n  }\r\n\r\n  function getMask(value: string) {\r\n    return value.length > 11 ? 'CNPJ' : 'CPF'\r\n  }\r\n\r\n  function applyMask(value: string, mask: string) {\r\n    let result = ''\r\n\r\n    let inc = 0\r\n    Array.from(value).forEach((letter, index) => {\r\n      if (!mask[index + inc].match(/[0-9]/)) {\r\n        result += mask[index + inc]\r\n        inc++\r\n      }\r\n      result += letter\r\n    })\r\n    return result\r\n  }\r\n\r\n  const InnerInput = as\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {InnerInput ? (\r\n        <InnerInput\r\n          {...rest}\r\n          style={style}\r\n          name={name}\r\n          label='CPF/CNPJ'\r\n          data-testid={'cpf-cnpj'}\r\n          type={type}\r\n          defaultValue={maskedValue}\r\n          onChange={onLocalChange}\r\n        />\r\n      ) : (\r\n        <input\r\n          {...rest}\r\n          style={style}\r\n          name={name}\r\n          data-testid={'cpf-cnpj'}\r\n          type={type}\r\n          defaultValue={maskedValue}\r\n          onChange={onLocalChange}\r\n        />\r\n      )}\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default CpfCnpjInput\r\n"],"names":["clearCpfCnpj","value","replace","CpfCnpjInput","as","style","name","onChange","type","rest","TYPES","CPF","CNPJ","MAX_LENGTH","length","stringValue","String","clearedValue","maskedValue","applyMask","getMask","onLocalChange","ev","target","mask","nextLength","substring","result","inc","Array","from","forEach","letter","index","match","InnerInput","React","Fragment","label","defaultValue"],"mappings":";;;;;;;;;;;;;;;;;;SASgBA,YAAY,CAACC,KAAa;EACxC,OAAOA,KAAK,IAAIA,KAAK,CAACC,OAAO,CAAC,SAAS,EAAE,EAAE,CAAC;AAC9C;AAUA,IAAMC,YAAY,GAA6C,SAAzDA,YAAY;MAChBC,EAAE,QAAFA,EAAE;IACFC,KAAK,QAALA,KAAK;IAAA,iBACLC,IAAI;IAAJA,IAAI,0BAAG,UAAU;IAAA,kBACjBL,KAAK;IAALA,KAAK,2BAAG,EAAE;IACVM,QAAQ,QAARA,QAAQ;IACRC,IAAI,QAAJA,IAAI;IACDC,IAAI;EAEP,IAAMC,KAAK,GAAG;IACZC,GAAG,EAAE,iBAAiB;IACtBC,IAAI,EAAE;GACP;EACD,IAAMC,UAAU,GAAGb,YAAY,CAACU,KAAK,CAACE,IAAI,CAAC,CAACE,MAAM;EAElD,IAAMC,WAAW,GAAGC,MAAM,CAACf,KAAK,CAAC;EAEjC,IAAMgB,YAAY,GAAGjB,YAAY,CAACe,WAAW,CAAC;EAC9C,IAAMG,WAAW,GAAGD,YAAY,GAC5BE,SAAS,CAACF,YAAY,EAAEP,KAAK,CAACU,OAAO,CAACH,YAAY,CAAC,CAAC,CAAC,GACrDA,YAAY;EAEhB,SAASI,aAAa,CAACC,EAAuC;IAC5D,IAAMrB,KAAK,GAAGD,YAAY,CAACsB,EAAE,CAACC,MAAM,CAACtB,KAAK,CAAC;IAC3C,IAAMuB,IAAI,GAAGJ,OAAO,CAACnB,KAAK,CAAC;IAE3B,IAAIwB,UAAU,GAAGxB,KAAK,CAACa,MAAM;IAE7B,IAAMI,WAAW,GACfO,UAAU,GAAGZ,UAAU,GACnBM,SAAS,CAAClB,KAAK,CAACyB,SAAS,CAAC,CAAC,EAAEb,UAAU,CAAC,EAAEH,KAAK,CAACc,IAAI,CAAC,CAAC,GACtDL,SAAS,CAAClB,KAAK,EAAES,KAAK,CAACc,IAAI,CAAC,CAAC;IAEnCF,EAAE,CAACC,MAAM,CAACtB,KAAK,GAAGiB,WAAW;IAE7BX,QAAQ,IAAIA,QAAQ,CAACe,EAAE,CAAC;;EAG1B,SAASF,OAAO,CAACnB,KAAa;IAC5B,OAAOA,KAAK,CAACa,MAAM,GAAG,EAAE,GAAG,MAAM,GAAG,KAAK;;EAG3C,SAASK,SAAS,CAAClB,KAAa,EAAEuB,IAAY;IAC5C,IAAIG,MAAM,GAAG,EAAE;IAEf,IAAIC,GAAG,GAAG,CAAC;IACXC,KAAK,CAACC,IAAI,CAAC7B,KAAK,CAAC,CAAC8B,OAAO,CAAC,UAACC,MAAM,EAAEC,KAAK;MACtC,IAAI,CAACT,IAAI,CAACS,KAAK,GAAGL,GAAG,CAAC,CAACM,KAAK,CAAC,OAAO,CAAC,EAAE;QACrCP,MAAM,IAAIH,IAAI,CAACS,KAAK,GAAGL,GAAG,CAAC;QAC3BA,GAAG,EAAE;;MAEPD,MAAM,IAAIK,MAAM;KACjB,CAAC;IACF,OAAOL,MAAM;;EAGf,IAAMQ,UAAU,GAAG/B,EAAE;EAErB,OACEgC,oBAACA,KAAK,CAACC,QAAQ,QACZF,UAAU,GACTC,oBAACD,UAAU,oBACL1B,IAAI;IACRJ,KAAK,EAAEA,KAAK;IACZC,IAAI,EAAEA,IAAI;IACVgC,KAAK,EAAC,UAAU;mBACH,UAAU;IACvB9B,IAAI,EAAEA,IAAI;IACV+B,YAAY,EAAErB,WAAW;IACzBX,QAAQ,EAAEc;KACV,GAEFe,+CACM3B,IAAI;IACRJ,KAAK,EAAEA,KAAK;IACZC,IAAI,EAAEA,IAAI;mBACG,UAAU;IACvBE,IAAI,EAAEA,IAAI;IACV+B,YAAY,EAAErB,WAAW;IACzBX,QAAQ,EAAEc;KAEb,CACc;AAErB,CAAC;;;;"}