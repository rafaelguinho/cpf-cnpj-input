{"version":3,"file":"index.modern.js","sources":["../src/components/CpfCnpjInput/index.tsx"],"sourcesContent":["import React from 'react'\r\n\r\ntype CpfCnpjInputProps = {\r\n  as?: React.FC<any & InputProps>\r\n  style?: React.CSSProperties\r\n  alwaysShowMask?: boolean\r\n  defaultMaskType?: 'CPF' | 'CNPJ'\r\n}\r\n\r\ntype InputProps = JSX.IntrinsicElements['input']\r\n\r\nexport function clearCpfCnpj(value: string) {\r\n  return value && value.replace(/[^0-9]/g, '')\r\n}\r\n\r\nexport function isCpf(value: string) {\r\n  return value.length === 11\r\n}\r\n\r\nexport function isCnpj(value: string) {\r\n  return value.length === 14\r\n}\r\n\r\nconst TYPES = {\r\n  CPF: '999.999.999-999',\r\n  CNPJ: '99.999.999/9999-99'\r\n}\r\n\r\nconst DEFAULT_MASKS = {\r\n  CPF: '___.___.___-__',\r\n  CNPJ: '__.___.___/____-__'\r\n}\r\n\r\nconst CpfCnpjInput: React.FC<CpfCnpjInputProps & InputProps> = ({\r\n  as,\r\n  style,\r\n  alwaysShowMask = false,\r\n  defaultMaskType = 'CPF',\r\n  value = '',\r\n  onChange,\r\n  ...rest\r\n}: CpfCnpjInputProps & InputProps) => {\r\n  const MAX_LENGTH = clearCpfCnpj(TYPES.CNPJ).length\r\n\r\n  const stringValue = String(value)\r\n\r\n  const clearedValue = clearCpfCnpj(stringValue)\r\n  const maskedValue = clearedValue\r\n    ? applyMask(clearedValue, TYPES[getMask(clearedValue)])\r\n    : alwaysShowMask\r\n    ? DEFAULT_MASKS[defaultMaskType]\r\n    : clearedValue\r\n\r\n  console.log('clearedValue', clearedValue)\r\n\r\n  function onLocalChange(ev: React.ChangeEvent<HTMLInputElement>) {\r\n    const value = clearCpfCnpj(ev.target.value)\r\n    const mask = getMask(value)\r\n\r\n    let nextLength = value.length\r\n\r\n    const maskedValue =\r\n      nextLength > MAX_LENGTH\r\n        ? applyMask(value.substring(0, MAX_LENGTH), TYPES[mask])\r\n        : applyMask(value, TYPES[mask])\r\n\r\n    ev.target.value = maskedValue\r\n\r\n    onChange && onChange(ev)\r\n  }\r\n\r\n  function getMask(value: string) {\r\n    return value.length > 11 ? 'CNPJ' : 'CPF'\r\n  }\r\n\r\n  function applyMask(value: string, mask: string) {\r\n    let result = ''\r\n\r\n    let inc = 0\r\n    Array.from(value).forEach((letter, index) => {\r\n      if (!mask[index + inc].match(/[0-9]/)) {\r\n        result += mask[index + inc]\r\n        inc++\r\n      }\r\n      result += letter\r\n    })\r\n    return result\r\n  }\r\n\r\n  const InnerInput = as\r\n\r\n  return (\r\n    <React.Fragment>\r\n      {InnerInput ? (\r\n        <InnerInput\r\n          {...rest}\r\n          style={style}\r\n          label='CPF/CNPJ'\r\n          data-testid={'cpf-cnpj'}\r\n          type='text'\r\n          defaultValue={maskedValue}\r\n          onChange={onLocalChange}\r\n        />\r\n      ) : (\r\n        <input\r\n          {...rest}\r\n          style={style}\r\n          data-testid={'cpf-cnpj'}\r\n          type='text'\r\n          defaultValue={maskedValue}\r\n          onChange={onLocalChange}\r\n        />\r\n      )}\r\n    </React.Fragment>\r\n  )\r\n}\r\n\r\nexport default CpfCnpjInput\r\n"],"names":["clearCpfCnpj","value","replace","TYPES","CPF","CNPJ","DEFAULT_MASKS","CpfCnpjInput","as","style","alwaysShowMask","defaultMaskType","onChange","rest","MAX_LENGTH","length","stringValue","String","clearedValue","maskedValue","applyMask","getMask","console","log","onLocalChange","ev","target","mask","nextLength","substring","result","inc","Array","from","forEach","letter","index","match","InnerInput","React","Fragment","label","type","defaultValue"],"mappings":"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"}